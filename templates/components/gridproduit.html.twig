<!-- =====  PRODUCT TAB  ===== -->
<div id="product-tab" class="mt_40">
	<div class="heading-part mb_20 ">
		<h2 class="main_title">
			Nos Produits
		</h2>
	</div>
	<ul class="nav text-right">
		<li class="active">
			<a href="#nArrivals" data-toggle="tab">
				New Arrivals
			</a>
		</li>
		<li>
			<a href="#Bestsellers" data-toggle="tab">
				Bestsellers
			</a>
		</li>
		<li>
			<a href="#Featured" data-toggle="tab">
				Featured
			</a>
		</li>
	</ul>
	<div class="tab-content clearfix box">
		<div class="tab-pane active" id="nArrivals">
			<div class="nArrivals owl-carousel">

				{% for product in products %}
					<div class="product-grid">

						<div class="item">
							<div class="product-thumb">
								<div class="image product-imageblock">
									<a href="{{ path('AfficheProduitClientDetaill',{'id':product.id}) }}">
										<img data-name="product_image" src="{{ asset('uploads/images/') ~ '/' ~ product.image }}" alt="iPod Classic" title="{{ product.title }}" class="img-responsive">
										<img src="{{ asset('uploads/images/') ~ '/' ~ product.image }}" alt="iPod Classic" title="{{ product.title }}" >
									</a>
								</div>
								<div class="likebtn">
									<a href="{{ path('Product_like',{'id': product.id }) }}" class="likebtn btn btn-link js-like">
										{%  if  app.user and product.isLikedByUser(app.user)  %}
											<i class="fas fa-thumbs-up"></i>
										{% else %}
											<i class="far fa-thumbs-up"></i>
										{% endif %}
										<span class="js-likes">
											{{ product.likes | length }}
										</span>
										<span class="js-label">
											j'aime
										</span>
									</a>
									</div>
								<div class="caption product-detail text-left">
									<h6 data-name="product_name" class="product-name mt_20">
										<a href="#" title="{{ product.title }}">
											{{ product.title }}
										</a>
									</h6>
									<div class="rating"></div>
									<span class="price">
										<span class="amount">
											<span class="currencySymbol">
												€
											</span>
											{{ product.price }}
										</span>
									</span>
									{% if app.user %}
									<div class="button-group text-center">
										<a href="{{ path('add_item', {'id': product.id} ) }}">
											<div class="add-to-cart">
												<span>
													Add to cart
												</span>
											</div>
										</a>
									</div>
									{% else %}
										<div class="button-group text-center">
											<a href="{{ path('app_login') }}">
												<div class="add-to-cart">
												<span>
													Add to cart
												</span>
												</div>
											</a>
										</div>
									{% endif %}
								</div>
							</div>
						</div>

					</div>
				{% endfor %}
			</div>
			<div class="tab-pane" id="Bestsellers">
				<div
					class="Bestsellers owl-carousel"><!-- ===== bestsellers goes here ==== -->
				</div>
			</div>
			<div class="tab-pane" id="Featured">
				<div
					class="Featured owl-carousel"><!-- ===== Featured goes here ==== -->
				</div>
			</div>
		</div>
	</div>
</div>
<!-- =====  PRODUCT TAB  END ===== -->
{% block javascripts %}
	<script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
	<script>

		function onClickBtnLike( event )
{
event.preventDefault();

const url = this.href;
const spanCount = this.querySelector( 'span.js-likes' );
const icone = this.querySelector( 'i' )

axios.get( url ).then( function ( response )
{

spanCount.textContent = response.data.likes; // mise à jour du nbre du likes

if ( icone.classList.contains( 'fas' ) )
{
icone.classList.replace( 'fas', 'far' );
}

else
{
icone.classList.replace( 'far', 'fas' );
}

} ).catch( function ( error )
{
if ( error.response.status === 403 )
{ // window.alert("vous ne pouvez pas liker un article si vous n'etes pas connecté !!!")
window.location.replace( '/login' ) }
else
{ // window.alert("une erreur s'est produite !!!")
window.location.replace( "/" ) }
} );
}

document.querySelectorAll( 'a.js-like' ).forEach( function ( link )
{
link.addEventListener( 'click', onClickBtnLike );
} )
	</script>
{% endblock %}
